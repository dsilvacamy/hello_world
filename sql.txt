select * FROM MYFUNDING.T_MYFUND_DEAL_REQUEST DEAL;

SELECT DISTINCT 

    DEAL.DEAL_ID,
	DEAL.DEAL_DISPLAY,
	DEAL.DEAL_NAME,
	DEAL.DEAL_STATUS_CODE,
	DEAL.DAY_TYPE,
	DEAL.DEAL_REQUESTER,
	DEAL.DEAL_PRIORITY_CODE,
	DEAL.PRIORITY_COMMENT,
	DEAL.RESPONSIBLE_TEAM_CODE,
	DEAL.AFFIRM_DUE_DATE,
	DEAL.BUS_TAX_CONTACT,
	DEAL.BUS_CONTROLLER_CONTACT,
	DEAL.CREATE_TIMESTAMP,
	DEAL.CREATE_USER,
	DEAL.DEAL_REQUEST_TIMESTAMP,
	DEAL.LAST_UPDATE_TIMESTAMP,
	DEAL.LAST_UPDATE_USER,
	DEAL.DEAL_RATIONALE, 
	
	DEAL.USD_EQUIVALENT_AMOUNT,
	DEAL.MDM_BUSINESS_TYPE,
	
	TRA.DEAL_TRANSACTION_ID DEAL_TRANSACTION_ID,
	TRA.DEAL_ID T_DEAL_ID, 
	TRA.TYPE_CODE T_TYPE_CODE, 
	TRA.SUB_TYPE_CODE T_SUB_TYPE_CODE, 
	TRA.AMOUNT T_AMOUNT, 
	TRA.FO_OWNER T_FO_OWNER, 
	TRA.MDM_CURRENCY_CODE T_MDM_CURRENCY_CODE, 
	TRA.IS_WSS_MANAGED T_IS_WSS_MANAGED, 
	TRA.EXECUTION_STATUS_CODE T_EXECUTION_STATUS_CODE, 
	TRA.IS_CROSS_BORDER T_IS_CROSS_BORDER, 
	TRA.IS_CASH_NONCASH T_IS_CASH_NONCASH, 
	TRA.IS_WITHHLD_TAX T_IS_WITHHLD_TAX, 
	TRA.WITHHLD_TAX_RATE T_WITHHLD_TAX_RATE, 
	TRA.LEGAL_AGREEMENT_CODE T_LEGAL_AGREEMENT_CODE, 
	TRA.LEGAL_AGREEMENT_COMMENT T_LEGAL_AGREEMENT_COMMENT, 
	TRA.DAY_TYPE T_DAY_TYPE, 
	TRA.FLOAT_RATE_IDX T_FLOAT_RATE_IDX, 
	TRA.FLOAT_RAT_IDX_TERM T_FLOAT_RAT_IDX_TERM, 
	TRA.SPREAD_BPS T_SPREAD_BPS, 
	TRA.IS_DISCONNECT T_IS_DISCONNECT, 
	TRA.CREATE_TIMESTAMP T_CREATE_TIMESTAMP, 
	TRA.CREATE_USER T_CREATE_USER, 
	TRA.LAST_UPDATE_TIMESTAMP T_LAST_UPDATE_TIMESTAMP, 
	TRA.LAST_UPDATE_USER T_LAST_UPDATE_USER,
	TRA.WSS_TRADE_ID,TRA.LOAN_START_DATE,TRA.MATURITY_DATE,TRA.LOAN_TERM,TRA.IS_IMMEDIATE_DRAWDOWN,TRA.IMMEDIATE_DRAWDOWN_AMT,TRA.COMMITMENT_FEE,
	TRA.GUARANTEE_FEE,TRA.IS_GUARANTEE_DOC,TRA.INTEREST_TYPE,TRA.EVENT_TYPE_CODE,TRA.USD_EQUIVALENT_AMOUNT T_USD_EQUIVALENT_AMOUNT,
	
	BUS.BUSINESS_ENTITY_ID BUS_BUSINESS_ENTITY_ID, 
	BUS.BUSINESS_ENTITY_CODE BUS_BUSINESS_ENTITY_CODE, 
	BUS.GOLD_LE BUS_GOLD_LE, 
	BUS.COMPANY_CODE BUS_COMPANY_CODE, 
	BUS.BUSINESS_UNIT BUS_BUSINESS_UNIT, 
	BUS.T_CODE BUS_T_CODE, 
	BUS.CURRENCY_CODE BUS_CURRENCY_CODE,
	BUS.CDR_CODE BUS_CDR_CODE, 
	BUS.IS_REGULATED BUS_IS_REGULATED, 
	BUS.NAME BUS_NAME, 
	BUS.COUNTRY BUS_COUNTRY, 
	BUS.BUSINESS_TYPE BUS_BUSINESS_TYPE, 
	BUS.DEAL_TRANSACTION_ID BUS_DEAL_TRANSACTION_ID, 
	BUS.CREATE_TIMESTAMP BUS_CREATE_TIMESTAMP, 
	BUS.CREATE_USER BUS_CREATE_USER, 
	BUS.LAST_UPDATE_TIMESTAMP BUS_LAST_UPDATE_TIMESTAMP, 
	BUS.LAST_UPDATE_USER BUS_LAST_UPDATE_USER,
	BUS.BUSINESS_SEGMENT BUS_BUSINESS_SEGMENT,
	BUS.STATUS BUS_STATUS,
	
	DOC.DOCUMENT_ID DO_DOCUMENT_ID,
	DOC.DOC_TYPE_CODE DO_DOC_TYPE_CODE, 
	DOC.FILE_ID DO_FILE_ID, 
	DOC.FOLDER_ID DO_FOLDER_ID, 
	DOC.DOC_URL DO_DOC_URL, 
	DOC.FILE_NAME DO_FILE_NAME, 
	DOC.DOC_COMMENT DO_DOC_COMMENT, 
	DOC.DEAL_ID DO_DEAL_ID, 
	DOC.DEAL_TRANSACTION_ID DO_DEAL_TRANSACTION_ID, 
	DOC.CREATE_TIMESTAMP DO_CREATE_TIMESTAMP, 
	DOC.CREATE_USER DO_CREATE_USER, 
	DOC.LAST_UPDATE_TIMESTAMP DO_LAST_UPDATE_TIMESTAMP, 
	DOC.LAST_UPDATE_USER DO_LAST_UPDATE_USER, 
	DOC.DOC_LEVEL DO_DOC_LEVEL,
	DOC.IS_ACTIVE DO_IS_ACTIVE,
	
	DTR.DOCUMENT_ID DTR_DOCUMENT_ID, 
	DTR.DOC_TYPE_CODE DTR_DOC_TYPE_CODE, 
	DTR.FILE_ID DTR_FILE_ID, 
	DTR.FOLDER_ID DTR_FOLDER_ID, 
	DTR.DOC_URL DTR_DOC_URL, 
	DTR.FILE_NAME DTR_FILE_NAME, 
	DTR.DOC_COMMENT DTR_DOC_COMMENT, 
	DTR.DEAL_ID DTR_DEAL_ID, 
	DTR.DEAL_TRANSACTION_ID DTR_DEAL_TRANSACTION_ID, 
	DTR.CREATE_TIMESTAMP DTR_CREATE_TIMESTAMP, 
	DTR.CREATE_USER DTR_CREATE_USER, 
	DTR.LAST_UPDATE_TIMESTAMP DTR_LAST_UPDATE_TIMESTAMP, 
	DTR.LAST_UPDATE_USER DTR_LAST_UPDATE_USER, 
	DTR.DOC_LEVEL DTR_DOC_LEVEL,
	DTR.IS_ACTIVE DTR_IS_ACTIVE,
	
	TEAM.DEAL_TEAM_ACTOR_ID TEAM_DEAL_TEAM_ACTOR_ID, 
	TEAM.DEAL_TEAM_ACTOR_CODE TEAM_DEAL_TEAM_ACTOR_CODE, 
	TEAM.OWNER TEAM_OWNER, 
	TEAM.COMMENTS TEAM_COMMENTS, 
	TEAM.NOTES TEAM_NOTES, 
	TEAM.ASSESSMENT TEAM_ASSESSMENT, 
	TEAM.RATIONALE TEAM_RATIONALE, 
	TEAM.TEAM_ACTOR_STATUS_CODE TEAM_TEAM_ACTOR_STATUS_CODE, 
	TEAM.DEAL_ID TEAM_DEAL_ID, 
	TEAM.CREATE_TIMESTAMP TEAM_CREATE_TIMESTAMP, 
	TEAM.CREATE_USER TEAM_CREATE_USER, 
	TEAM.LAST_UPDATE_TIMESTAMP TEAM_LAST_UPDATE_TIMESTAMP, 
	TEAM.LAST_UPDATE_USER TEAM_LAST_UPDATE_USER,
	TEAM.STATUS TEAM_STATUS
	
	
FROM MYFUNDING.T_MYFUND_DEAL_REQUEST DEAL
LEFT OUTER JOIN MYFUNDING.T_MYFUND_DEAL_TRANSACTION TRA ON (DEAL.DEAL_ID = TRA.DEAL_ID )
LEFT OUTER JOIN MYFUNDING.T_MYFUND_MDM_BUSINESS_ENTITY BUS ON TRA.DEAL_TRANSACTION_ID = BUS.DEAL_TRANSACTION_ID AND BUS.STATUS = 'ACTIVE'
LEFT OUTER JOIN MYFUNDING.T_MYFUND_DOCUMENT DOC ON (DEAL.DEAL_ID = DOC.DEAL_ID AND DOC.DOC_LEVEL='Deal' AND NVL(DOC.IS_ACTIVE,'Y') = 'Y')
LEFT OUTER JOIN MYFUNDING.T_MYFUND_DOCUMENT DTR ON (DEAL.DEAL_ID = DTR.DEAL_ID AND TRA.DEAL_TRANSACTION_ID = DTR.DEAL_TRANSACTION_ID AND DTR.DOC_LEVEL='Transaction' AND NVL(DTR.IS_ACTIVE,'Y') = 'Y')
LEFT OUTER JOIN MYFUNDING.T_MYFUND_DEAL_TEAM_ACTOR TEAM ON DEAL.DEAL_ID = TEAM.DEAL_ID  AND TEAM.STATUS = 'ACTIVE'
    where DEAL.DEAL_ID = 123456 and DEAL.DEAL_STATUS_CODE != 'DEALSTATUS_CANCEL' 
    order by TRA.LAST_UPDATE_TIMESTAMP